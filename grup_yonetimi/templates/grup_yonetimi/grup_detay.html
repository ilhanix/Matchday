<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>{{ grup.grup_adi }} DetaylarÄ±</title>
</head>
<body>
    <h1>{{ grup.grup_adi }}</h1>
    
    <a href="{% url 'mac_listesi' grup.id %}">[MaÃ§lara Git]</a> | 
    <a href="{% url 'ana_sayfa' %}">[Ana Sayfaya DÃ¶n]</a>

    <hr>
    {% if grup.yonetici == user %}
    <h2>YÃ¶neticilik Kontrolleri</h2>
    <hr>
    <h3>Grup Bilgilerini ve GizliliÄŸi DÃ¼zenle</h3>
    <form method="post" enctype="multipart/form-data" action="{% url 'grup_detay' grup.id %}">
        {% csrf_token %}
        <p>
            <label for="{{ grup_formu.grup_adi.id_for_label }}">Grup AdÄ±:</label>
            {{ grup_formu.grup_adi }}
        </p>
        
        <p>
            <label for="{{ grup_formu.grup_resmi.id_for_label }}">Grup Resmi:</label>
            {{ grup_formu.grup_resmi }}
        </p>

        <p>
            {{ grup_formu.herkese_gorunur }}
            <label for="{{ grup_formu.herkese_gorunur.id_for_label }}">Herkese AÃ§Ä±k (KatÄ±lÄ±m Listesinde GÃ¶rÃ¼nÃ¼r)</label>
        </p>
        
        <button type="submit">Grup AyarlarÄ±nÄ± Kaydet</button>
    </form>
    <h3>Oyuncu Davet Et</h3>
    <form method="post" action="{% url 'davet_gonder' grup.id %}">
        {% csrf_token %}
        <label for="davet_edilecek_user">KullanÄ±cÄ± AdÄ± veya E-posta:</label>
        <input type="text" id="davet_edilecek_user" name="davet_edilecek_user" required placeholder="KullanÄ±cÄ± AdÄ± / E-posta">
        <button type="submit">Davet GÃ¶nder</button>
    </form>
    
    <hr>
    
{% endif %}
    {% if not grup_durumu %}
        <h2>Gruba KatÄ±l</h2>
        <p>Bu gruba Ã¼ye deÄŸilsiniz.</p>
        <form method="post" action="{% url 'grup_katil' grup.id %}">
            {% csrf_token %}
            <button type="submit">Gruba KatÄ±lÄ±m Talebi GÃ¶nder</button>
        </form>
    {% elif grup_durumu.onay_durumu == 'B' %}
        <p style="color: orange;">KatÄ±lÄ±m talebiniz beklemede. YÃ¶netici onayÄ±nÄ± bekleyiniz.</p>
    {% elif grup_durumu.onay_durumu == 'O' %}
        <p style="color: green;">Bu grubun onaylÄ± Ã¼yesisiniz. MaÃ§lara katÄ±labilirsiniz!</p>
    {% endif %}

    {% if is_yonetici and bekleyen_talepler %}
        <h2>ğŸ“ Bekleyen KatÄ±lÄ±m Talepleri ({{ bekleyen_talepler|length }})</h2>
        <ul>
            {% for talep in bekleyen_talepler %}
                <li>
                    {{ talep.oyuncu.username }} ({{ talep.oyuncu.email|default:"E-posta yok" }})
                    
                    <form method="post" action="{% url 'grup_onayla' talep.id %}" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" name="action" value="onayla" style="color: green;">Onayla</button>
                    </form>
                    
                    <form method="post" action="{% url 'grup_onayla' talep.id %}" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" name="action" value="reddet" style="color: red;">Reddet</button>
                    </form>
                </li>
            {% endfor %}
        </ul>
    {% endif %}

    <h2>ğŸ‘¥ Grup Ãœyeleri ({{ uyeler|length }})</h2>
    <ul>
        {% for uye in uyeler %}
            <li>
                {{ uye.oyuncu.username }} - Mevki: {{ uye.oyuncu.oyuncuprofili.get_mevkii_display|default:"BelirtilmemiÅŸ" }} 
                (MaÃ§: {{ uye.oynadigi_mac }}, Gol: {{ uye.gol }})
            </li>
        {% endfor %}
    </ul>
    
</body>
</html>